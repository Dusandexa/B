# Block search engine indexing (remove this when ready to go public)
<IfModule mod_headers.c>
    Header set X-Robots-Tag "noindex, nofollow, noarchive"
</IfModule>

# Enable RewriteEngine
RewriteEngine On

# Set the base directory
RewriteBase /

# Remove trailing slash from non-directory URLs
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} (.+)/$
RewriteRule ^ %1 [L,R=301]

# Remove .php extension if it exists in URL
RewriteCond %{THE_REQUEST} ^[A-Z]{3,}\s([^.]+)\.php [NC]
RewriteRule ^ %1 [R=301,L]

# Route requests to PHP files (English pages)
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME}.php -f
RewriteRule ^(.*)$ $1.php [L]

# Route requests to PHP files in /srb/ directory (Serbian pages)
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME}.php -f
RewriteRule ^srb/(.*)$ srb/$1.php [L]

# Custom 404 error page (optional)
# ErrorDocument 404 /404.php

# Prevent direct access to includes directory
<IfModule mod_rewrite.c>
RewriteRule ^includes/ - [F,L]
</IfModule>

# Prevent direct access to forms directory (optional, for security)
<IfModule mod_rewrite.c>
RewriteRule ^forms/ - [F,L]
</IfModule>

# Security: Prevent access to .htaccess and other hidden files
<FilesMatch "^\.">
    Order allow,deny
    Deny from all
</FilesMatch>

# UTF-8 encoding for all text files
AddDefaultCharset UTF-8

# Enable gzip compression (optional, for performance)
<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE text/html text/plain text/xml text/css text/javascript application/javascript application/json
</IfModule>

# Browser caching (optional, for performance)
<IfModule mod_expires.c>
    ExpiresActive On
    ExpiresByType image/jpg "access plus 1 year"
    ExpiresByType image/jpeg "access plus 1 year"
    ExpiresByType image/gif "access plus 1 year"
    ExpiresByType image/png "access plus 1 year"
    ExpiresByType image/svg+xml "access plus 1 year"
    ExpiresByType text/css "access plus 1 month"
    ExpiresByType application/javascript "access plus 1 month"
    ExpiresByType text/javascript "access plus 1 month"
</IfModule>
